  <div class="half-price">
    <div class="container">
      <div class="spacer125"></div>
			{{ with .Site.GetPage "halfPrice" }}
			<h2 class="half-price__heading">
				{{ replace .Params.heading "\n" "<br/>" | safeHTML}}
			</h2>
			<div class="spacer40"></div>
			<div class="spacer60"></div>
      <div class="row">
				<div class="half-price__content col-sm-12 col-md-12 offset-sm-0 offset-lg-1 col-lg-4 pt-5 pl-5">
					<div class="half-price__input-wrapper">
			      <label aria-label="storage" class="half-price__label my-2">Storage</label>
			      <input type="text" id="storage" class="half-price__input" name="storage" value="1" required>
						<div class="half-price__measures">
							<p class="half-price__measure-text storage-measure">GB</p>
							<p style="color:#2582FF" class="half-price__measure-text storage-measure">TB</p>
						</div>
					</div>
					<div class="half-price__input-wrapper">
			      <label aria-label="download" class="half-price__label my-2">Download</label>
			      <input type="text" id="download" class="half-price__input" name="download" value="1000" required>
						<div class="half-price__measures">
							<p style="color:#2582FF" class="half-price__measure-text download-measure">GB</p>
							<p class="half-price__measure-text download-measure">TB</p>
						</div>
					</div>
					<div class="form-check mt-4">
						<input type="checkbox" class="form-check-input" id="zonesCheck">
						<label class="form-check-label" for="exampleCheck1">Multiple Availability Zones</label>
					</div>
					<div class="half-price__tardigrade-calculation pt-4">
						<h4 id="estimate" class="half-price__estimate__price"></h4>
						<p class="half-price__estimate__text">Estimated Monthly Cost</p>
					</div>
				</div>
				<div id="charts" class="half-price__content col-sm-12 col-md-12 col-lg-6 py-5">
					<img src="/img/pricing-chart.svg" alt="Pricing Chart" />
					<div class="half-price__competitors d-flex">
						<p style="color:#2582FF" id="tardigradeEstimate" class="half-price__competitors__price pr-3"></p>
						<p id="amazonEstimate" class="half-price__competitors__price pr-2"></p>
						<p id="googleEstimate" class="half-price__competitors__price pr-1"></p>
						<p id="microsoftEstimate" class="half-price__competitors__price pl-1"></p>
					</div>
					<div class="half-price__tardigrade-calculation__sm pt-4 pl-5">
						<h4 id="estimateSm" class="half-price__estimate__price"></h4>
						<p class="half-price__estimate__text">Estimated Monthly Cost</p>
					</div>
				</div>
				<div id="petabyteContactCta" class="col-sm-12 col-lg-7 py-5">
					<div class="half-price__peta-contact text-center pt-5">
						<h4 class="text-center mx-auto mb-4 pt-4 w-75">Looking for Petabyte Storage Pricing?</h4>
						<button href="/contact-us" class="btn btn-primary">Contact Us</button>
					</div>
				</div>
      </div>
			<div class="spacer70"></div>
      <div class="text-center">
        <a class="btn btn-primary btn-lg" href="/signup">
  				{{ .Params.cta}}
  			</a>
				<p class="half-price__pricing-cta pt-4">Looking for Petabyte Storage Pricing?<a class="half-price__pricing-cta__link" href="#"> Contact Us</a></p>
      </div>
			{{ end }}
    </div>
    <div class="spacer125"></div>
  </div>

	<script type="text/javascript">
		var estimate = document.getElementById("estimate");
		var estimateSm = document.getElementById("estimateSm");
		var tardigradeEstimate = document.getElementById("tardigradeEstimate");
		var amazonEstimate = document.getElementById("amazonEstimate");
		var googleEstimate = document.getElementById("googleEstimate");
		var microsoftEstimate = document.getElementById("microsoftEstimate");
		var petabyteContactCta = document.getElementById("petabyteContactCta");
		var charts = document.getElementById("charts");
		var downloadMeasures = document.querySelectorAll(".download-measure")
		var storageMeasures = document.querySelectorAll(".storage-measure")
		var downloadInput = document.getElementById("download");
		var storageInput = document.getElementById("storage");

		// handle measure change by changing color to measure choice and triggering calculation
		var onChangeMeasure = function(measures, recentMeasureChoice, previousMeasureChoice) {
			if(measures) {
				measures.forEach(el => el.addEventListener('click', event => {
				  el.style.color="#2582FF";
					for (var i = 0; i < measures.length; i++) {
						if(el !== measures[i]) {
							measures[i].style.color="#AFB7C1";
						}
					}
					calculate(recentMeasureChoice, previousMeasureChoice)
				}));
			}
		}

		// all calculation logic
		var calculate = function(recentMeasureChoice, previousMeasureChoice) {
			var recentInputValue = "";
			var previousInputValue = "";
			var recentMeasureElements = ""
			var previousMeasureElements = ""
			var choiceOne = ""
			var choiceTwo = ""

			if(recentMeasureChoice === "storage") {
				 recentInputValue = document.getElementById("storage").value;
				 previousInputValue = document.getElementById("download").value;
				 previousMeasureElements = document.querySelectorAll(".download-measure")
				 recentMeasureElements = document.querySelectorAll(".storage-measure")
			} else if(recentMeasureChoice === "download") {
				 previousInputValue = document.getElementById("storage").value;
				 recentInputValue = document.getElementById("download").value;
				 previousMeasureElements = document.querySelectorAll(".storage-measure")
				 recentMeasureElements = document.querySelectorAll(".download-measure")
			}

			for (var i = 0; i < previousMeasureElements.length; i++) {
				if(previousMeasureElements[i].style.color === "rgb(37, 130, 255)") {
					choiceTwo = previousMeasureElements[i].textContent
				}
			}

			for (var i = 0; i < recentMeasureElements.length; i++) {
				if(recentMeasureElements[i].style.color === "rgb(37, 130, 255)") {
					choiceOne = recentMeasureElements[i].textContent
				}
			}

			if(petabyteCalcCheck(choiceOne, recentInputValue) || petabyteCalcCheck(choiceTwo, previousInputValue)) {
				charts.style.display="none";
				petabyteContactCta.style.display="block"
			} else {
				charts.style.display="block";
				petabyteContactCta.style.display="none"
			}

			var calculation = (recentInputValue * tardigradeCalculation(choiceOne, recentMeasureChoice)) + (previousInputValue * tardigradeCalculation(choiceTwo, previousMeasureChoice))

			var tardiradeCalculation = "$" + Math.ceil(calculation * 100) / 100

			estimate.textContent = tardiradeCalculation
			estimateSm.textContent = tardiradeCalculation
			tardigradeEstimate.textContent = tardiradeCalculation
			console.log("AMAZON:, ", amazonCalculation(recentInputValue, choiceOne, recentMeasureChoice), amazonCalculation(previousInputValue, choiceTwo, previousMeasureChoice), (amazonCalculation(recentInputValue, choiceOne, recentMeasureChoice)) + (amazonCalculation(previousInputValue, choiceTwo, previousMeasureChoice)))
			amazonEstimate.textContent = (amazonCalculation(recentInputValue, choiceOne, recentMeasureChoice)) + (amazonCalculation(previousInputValue, choiceTwo, previousMeasureChoice))
			googleEstimate.textContent = (googleCalculation(recentInputValue, choiceOne, recentMeasureChoice)) + (googleCalculation(previousInputValue, choiceTwo, previousMeasureChoice))
			microsoftEstimate.textContent = (microsoftCalculation(recentInputValue, choiceOne, recentMeasureChoice)) + (microsoftCalculation(previousInputValue, choiceTwo, previousMeasureChoice))
		}

		var amazonCalculation = function(input, measureChoice, serviceType) {
			if(serviceType === "storage") {
				if(measureChoice === "GB") {
					if(input <= 1000) {
						return input * .023
					} else if(input > 1000 && input <= 50000) {
						return input * .022
					} else if(input > 50000) {
						return input * .021
					}
				} else if(measureChoice === "TB") {
					if(input <= 1) {
						return input * .023
					} else if(input > 1 && input <= 50) {
						return input * .022
					} else if(input > 50) {
						return input * .021
					}
				}
			} else if(serviceType === "download") {
				if(measureChoice === "GB") {
					if(input >= 1 && input <= 10) {
						return input * .090
					} else if(input > 10 && input <= 50000) {
						return input * .085
					} else if(input > 50000 && input <= 150000) {
						return input * .070
					} else if(input > 150000) {
						return input * .050
					} else {
						return 0
					}
				} else if(measureChoice === "TB") {
					if(input >= .001 && input <= .01) {
						return input * .090
					} else if(input > .01 && input <= 50) {
						return input * .085
					} else if(input > 50 && input <= 150) {
						return input * .070
					} else if(input > 150) {
						return input * .50
					} else  {
						return 0
					}
				}
			}
		}

		var googleCalculation = function(input, measureChoice, serviceType) {
			if(serviceType === "storage") {
				return input * .026
			} else if(serviceType === "download") {
				if(measureChoice === "GB") {
					if(input >= 0 && input <= 1000) {
						return input * .120
					} else if(input > 1000 && input <= 10000) {
						return input * .110
					} else if(input > 10000) {
						return input * .080
					}
					return input * .080
				} else if(measureChoice === "TB") {
					if(input <= 1) {
						return input * .120
					} else if(input > 1 && input <= 10) {
						return input * .110
					} else if(input > 10) {
						return input * .080
					}
				}
			}
		}

		var microsoftCalculation = function(input, measureChoice, serviceType) {
			if(serviceType === "storage") {
				if(measureChoice === "GB") {
					return input * .0184
				} else if(measureChoice === "TB") {
					if(input >= 1 && input <= 50) {
						return input * .0184
					} else if(input > 50 && input <= 500) {
						return input * .0177
					} else if(input > 500) {
						return input * .0170
					} else {
						return 0
					}
				}
			} else if(serviceType === "download") {
				if(measureChoice === "GB") {
					if(input > 5 && input <= 10000) {
						return input * .0870
					} else if(input > 10000 && input <= 50000) {
						return input * .0830
					} else if(input > 50000 && input <= 150000) {
						return input * .070
					} else if(input > 150000 && input <= 350000) {
						return input * .050
					} else if(input > 350000) {
						return input * .050
					} else {
						return 0
					}
				} else if(measureChoice === "TB") {
					if(input <= .005) {
						return 0
					} else if(input > .005 && input <= 10) {
						return input * .087
					} else if(input > 10 && input <= 50) {
						return input * .083
					} else if(input > 50 && input <= 150) {
						return input * .070
					} else if(input > 150) {
						return input * .050
					}
				}
			}
		}


		var tardigradeCalculation = function(measureChoice, serviceType) {
			if(serviceType === "download") {
				if(measureChoice === "GB") {
					return .045
				} else if(measureChoice === "TB") {
					return 45
				}
			} else if(serviceType === "storage") {
				if(measureChoice === "GB") {
					return .01
				} else if(measureChoice === "TB") {
					return 10
				}
			}
		}

		// trigger calculation on every input change
		var onInputChange = function(input, recentMeasureChoice, previousMeasureChoice) {

			input.addEventListener('keyup', event => {
				if(input.value > 1) {
					calculate(recentMeasureChoice, previousMeasureChoice)
				}
			});
		}

		// check whether to render pricing question cta
		var petabyteCalcCheck = function(serviceType, input) {

			if(serviceType === "GB" && input * .00001 >= 1) {
				return true
			} else if(serviceType === "TB" && input * .001 >= 1) {
				return true
			}
			return false
		}

		// make initial calculation
		calculate("storage", "download")

		// add measure change event listeners
		onChangeMeasure(downloadMeasures, "download", "storage")
		onChangeMeasure(storageMeasures, "storage", "download")

		// add input change event listeners on both inputs
		onInputChange(downloadInput, "download", "storage")
		onInputChange(storageInput, "storage", "download")



	</script>
